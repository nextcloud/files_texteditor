kind: pipeline
name: build

steps:
  - name: webpack-build
    image: nextcloudci/node:node-4
    commands:
      - npm ci
      - NODE_ENV=production ./node_modules/.bin/webpack
      - git status
      - bash -c "[[ ! \"`git status --porcelain `\" ]] || ( echo 'Uncommited changes in webpack build' && exit 1 )"

trigger:
  branch:
    - master
    - stable*

